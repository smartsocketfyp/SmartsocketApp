{"ast":null,"code":"import _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nvar _jsxFileName = \"C:\\\\Users\\\\orange7332\\\\capstone\\\\code-18122020-combined\\\\Screens\\\\MainFunctionScreen.js\";\nimport * as React from 'react';\nimport { useEffect } from \"react\";\nimport View from \"react-native-web/dist/exports/View\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport TouchableOpacity from \"react-native-web/dist/exports/TouchableOpacity\";\nimport ScrollView from \"react-native-web/dist/exports/ScrollView\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport firebase from 'firebase/app';\nimport \"firebase/auth\";\nimport 'firebase/database';\nimport { useNetInfo } from \"@react-native-community/netinfo\";\n\nfunction MainFunctionScreen(_ref) {\n  var route = _ref.route,\n      navigation = _ref.navigation;\n  var data = route.params;\n  var netInfo = useNetInfo();\n\n  var _React$useState = React.useState(''),\n      _React$useState2 = _slicedToArray(_React$useState, 2),\n      StartPower = _React$useState2[0],\n      setStartPower = _React$useState2[1];\n\n  var _React$useState3 = React.useState(''),\n      _React$useState4 = _slicedToArray(_React$useState3, 2),\n      EndPower = _React$useState4[0],\n      setEndPower = _React$useState4[1];\n\n  useEffect(function () {\n    setImmediate(function () {\n      return handleAuthStateChange();\n    });\n    clearImmediate;\n  });\n\n  var handleAuthStateChange = function handleAuthStateChange() {\n    var database = firebase.database();\n    var auth = firebase.auth();\n    auth.onAuthStateChanged(function (user) {\n      if (user) {\n        database.ref('/Socket ID/' + data.slice(17, 20)).once('value').then(function (snapshot) {\n          setStartPower(snapshot.val() && snapshot.val().Cumulative_Power);\n        });\n      } else {\n        database.ref('/Socket ID/' + data.slice(17, 20)).once('value').then(function (snapshot) {\n          setEndPower(snapshot.val() && snapshot.val().Cumulative_Power);\n        });\n      }\n\n      console.log(\"Start Power is \" + StartPower);\n      console.log(\"End Power is \" + EndPower);\n    });\n  };\n\n  var handleSignOut = function handleSignOut() {\n    var database = firebase.database();\n    var user = firebase.auth().currentUser;\n    var now = new Date();\n    var date = now.getMonth() + 1 + \"-\" + now.getDate() + \",\" + now.getHours() + \":\" + now.getMinutes();\n    firebase.auth().signOut();\n    database.ref('/Socket ID/' + data.slice(17, 20)).once('value').then(function (snapshot) {\n      database.ref('/Socket ID/' + data.slice(17, 20) + '/User_Activity/' + date).update({\n        Power_Consumed: snapshot.val() && snapshot.val().Cumulative_Power - StartPower,\n        User_Email: user.email,\n        User_ID: user.uid,\n        Time_of_Sign_Out: now + \"\"\n      }).then(function (data) {\n        console.log('data', data);\n      }).catch(function (error) {\n        console.log('error', error);\n      });\n      database.ref('/Usage History/' + user.uid).push({\n        Power_Consumed: snapshot.val() && snapshot.val().Cumulative_Power - StartPower,\n        Socket_Used: data.slice(17, 20),\n        Time_of_Sign_Out: now + \"\"\n      }).then(function (data) {\n        console.log('data', data);\n      }).catch(function (error) {\n        console.log('error', error);\n      });\n      setEndPower(snapshot.val() && snapshot.val().Cumulative_Power);\n    });\n    database.ref('/Socket ID/' + data.slice(17, 20)).update({\n      AppSwitch: 0,\n      Completion_Time: 0,\n      Current_User_Email: 'no user'\n    }).then(function (data) {\n      console.log('data', data);\n    }).catch(function (error) {\n      console.log('error', error);\n    });\n  };\n\n  var readDataforTimer = function readDataforTimer(_ref2) {\n    var data = _ref2.data;\n    firebase.database().ref('/Socket ID/' + data.slice(17, 20)).once('value').then(function (snapshot) {\n      var SocketStatus = snapshot.val() && snapshot.val().AppSwitch;\n\n      if (SocketStatus) {\n        navigation.push(\"Set Timer\", data);\n      } else if (!SocketStatus) {\n        alert('Socket has already been switched off');\n      } else {\n        alert('Please wait a while');\n      }\n    });\n  };\n\n  return React.createElement(ScrollView, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 104,\n      columnNumber: 9\n    }\n  }, React.createElement(View, {\n    style: netInfo.isConnected ? styles.Connection_Connected : styles.Connection_Disconnected,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 105,\n      columnNumber: 13\n    }\n  }, React.createElement(Text, {\n    style: netInfo.isConnected ? styles.Connection_Text : styles.Disconnection_Text,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 106,\n      columnNumber: 17\n    }\n  }, netInfo.isConnected === true ? 'You are connected to the device' : 'You are disconnected from the device')), React.createElement(View, {\n    style: styles.container,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 111,\n      columnNumber: 13\n    }\n  }, React.createElement(Text, {\n    style: styles.Title,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 112,\n      columnNumber: 17\n    }\n  }, \" Main Functions \"), React.createElement(Text, {\n    style: styles.Instructions,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 113,\n      columnNumber: 17\n    }\n  }, \" Control your Aily socket here. You are connected to Socket No. \", data.slice(17, 20), \" \"), React.createElement(TouchableOpacity, {\n    style: netInfo.isConnected ? styles.Navigation_Buttons : styles.Navigation_Buttons_Disabled,\n    disabled: netInfo.isConnected === false,\n    onPress: function onPress() {\n      return navigation.push(\"On Off\", data);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 115,\n      columnNumber: 17\n    }\n  }, React.createElement(Text, {\n    style: styles.Button_Text,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 120,\n      columnNumber: 21\n    }\n  }, \" Switch on/off socket \")), React.createElement(TouchableOpacity, {\n    style: netInfo.isConnected ? styles.Navigation_Buttons : styles.Navigation_Buttons_Disabled,\n    disabled: netInfo.isConnected === false,\n    onPress: function onPress() {\n      return readDataforTimer({\n        data: data\n      });\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 123,\n      columnNumber: 17\n    }\n  }, React.createElement(Text, {\n    style: styles.Button_Text,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 128,\n      columnNumber: 21\n    }\n  }, \" Switch on/off socket via schedule \")), React.createElement(TouchableOpacity, {\n    style: netInfo.isConnected ? styles.Navigation_Buttons : styles.Navigation_Buttons_Disabled,\n    disabled: netInfo.isConnected === false,\n    onPress: function onPress() {\n      return navigation.push(\"Power Usage\", {\n        data: data,\n        StartPower: StartPower\n      });\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 131,\n      columnNumber: 17\n    }\n  }, React.createElement(Text, {\n    style: styles.Button_Text,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 136,\n      columnNumber: 21\n    }\n  }, \" Check Power Consumption Here \")), React.createElement(TouchableOpacity, {\n    style: netInfo.isConnected ? styles.Navigation_Buttons : styles.Navigation_Buttons_Disabled,\n    disabled: netInfo.isConnected === false,\n    onPress: function onPress() {\n      return navigation.push(\"Past Usage\", {\n        StartPower: StartPower,\n        EndPower: EndPower\n      });\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 139,\n      columnNumber: 17\n    }\n  }, React.createElement(Text, {\n    style: styles.Button_Text,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 144,\n      columnNumber: 21\n    }\n  }, \" Past Usage of Aily Sockets \")), React.createElement(TouchableOpacity, {\n    style: styles.Navigation_Buttons,\n    onPress: function onPress() {\n      return navigation.navigate(\"Scan Now\");\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 147,\n      columnNumber: 17\n    }\n  }, React.createElement(Text, {\n    style: styles.Button_Text,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 151,\n      columnNumber: 21\n    }\n  }, \" Use a Different Aily Socket \")), React.createElement(TouchableOpacity, {\n    style: styles.Log_Out_Buttons,\n    onPress: function onPress() {\n      return handleSignOut() > navigation.navigate(\"Home\");\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 154,\n      columnNumber: 17\n    }\n  }, React.createElement(Text, {\n    style: styles.Button_Text,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 158,\n      columnNumber: 21\n    }\n  }, \" Log Out \"))));\n}\n\nvar styles = StyleSheet.create({\n  Connection_Connected: {\n    height: 70,\n    width: '100%',\n    flex: 1,\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'space-evenly',\n    backgroundColor: '#00F000',\n    flexWrap: 'wrap'\n  },\n  Connection_Disconnected: {\n    height: 70,\n    width: '100%',\n    flex: 1,\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'space-evenly',\n    backgroundColor: '#F00000',\n    flexWrap: 'wrap'\n  },\n  Connection_Text: {\n    textAlign: 'center',\n    color: \"#000000\",\n    fontWeight: \"300\",\n    marginTop: 50,\n    fontSize: 15\n  },\n  Disconnection_Text: {\n    textAlign: 'center',\n    color: \"#FFFFFF\",\n    fontWeight: \"300\",\n    marginTop: 50,\n    fontSize: 15\n  },\n  container: {\n    height: 575,\n    width: '100%',\n    flex: 1,\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'space-evenly',\n    backgroundColor: '#fff',\n    flexWrap: 'wrap'\n  },\n  Title: {\n    textAlign: 'center',\n    marginLeft: 50,\n    marginRight: 50,\n    marginTop: 10,\n    marginBottom: 10,\n    color: \"#000\",\n    fontWeight: \"bold\",\n    fontSize: 25\n  },\n  Instructions: {\n    textAlign: 'center',\n    marginLeft: 50,\n    marginRight: 50,\n    marginTop: 0,\n    marginBottom: 0,\n    color: \"#000\",\n    fontWeight: \"300\",\n    fontSize: 15\n  },\n  Navigation_Buttons: {\n    backgroundColor: '#000080',\n    borderRadius: 4,\n    height: 125,\n    width: 125,\n    marginLeft: 5,\n    marginRight: 5,\n    marginTop: 15,\n    marginBottom: 15,\n    alignItems: 'center',\n    alignSelf: 'flex-start',\n    justifyContent: 'center'\n  },\n  Navigation_Buttons_Disabled: {\n    backgroundColor: '#AAAAAA',\n    borderRadius: 4,\n    height: 125,\n    width: 125,\n    marginLeft: 5,\n    marginRight: 5,\n    marginTop: 15,\n    marginBottom: 15,\n    alignItems: 'center',\n    alignSelf: 'flex-start',\n    justifyContent: 'center'\n  },\n  Log_Out_Buttons: {\n    backgroundColor: '#A00000',\n    borderRadius: 4,\n    height: 125,\n    width: 125,\n    marginLeft: 5,\n    marginRight: 5,\n    marginTop: 15,\n    marginBottom: 15,\n    alignItems: 'center',\n    alignSelf: 'flex-start',\n    justifyContent: 'center'\n  },\n  Button_Text: {\n    textAlign: 'center',\n    color: \"#FFF\",\n    fontWeight: \"600\"\n  }\n});\nexport default MainFunctionScreen;","map":{"version":3,"sources":["C:/Users/orange7332/capstone/code-18122020-combined/Screens/MainFunctionScreen.js"],"names":["React","useEffect","firebase","useNetInfo","MainFunctionScreen","route","navigation","data","params","netInfo","useState","StartPower","setStartPower","EndPower","setEndPower","setImmediate","handleAuthStateChange","clearImmediate","database","auth","onAuthStateChanged","user","ref","slice","once","then","snapshot","val","Cumulative_Power","console","log","handleSignOut","currentUser","now","Date","date","getMonth","getDate","getHours","getMinutes","signOut","update","Power_Consumed","User_Email","email","User_ID","uid","Time_of_Sign_Out","catch","error","push","Socket_Used","AppSwitch","Completion_Time","Current_User_Email","readDataforTimer","SocketStatus","alert","isConnected","styles","Connection_Connected","Connection_Disconnected","Connection_Text","Disconnection_Text","container","Title","Instructions","Navigation_Buttons","Navigation_Buttons_Disabled","Button_Text","navigate","Log_Out_Buttons","StyleSheet","create","height","width","flex","flexDirection","alignItems","justifyContent","backgroundColor","flexWrap","textAlign","color","fontWeight","marginTop","fontSize","marginLeft","marginRight","marginBottom","borderRadius","alignSelf"],"mappings":"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","sourcesContent":["import * as React from 'react';\r\nimport {useEffect} from \"react\";\r\nimport { View, Text, TouchableOpacity, ScrollView, StyleSheet} from 'react-native';\r\nimport firebase from 'firebase/app';\r\nimport \"firebase/auth\";\r\nimport 'firebase/database';\r\nimport {useNetInfo} from \"@react-native-community/netinfo\";\r\n\r\nfunction MainFunctionScreen( {route, navigation} ) {\r\n    let data  = route.params;\r\n    const netInfo = useNetInfo();\r\n    const [StartPower, setStartPower] = React.useState('');\r\n    const [EndPower, setEndPower] = React.useState('');\r\n\r\n    useEffect(() => {\r\n        setImmediate(() => handleAuthStateChange());\r\n        clearImmediate;\r\n    });\r\n\r\n    const handleAuthStateChange = () => {\r\n        var database = firebase.database();\r\n        var auth = firebase.auth();\r\n\r\n        auth.onAuthStateChanged(function(user) {\r\n            if (user) {\r\n                database.ref('/Socket ID/' + data.slice(17,20)).once('value').then((snapshot) => {\r\n                setStartPower((snapshot.val() && snapshot.val().Cumulative_Power)) ;\r\n                })\r\n            }\r\n\r\n            else {\r\n                database.ref('/Socket ID/' + data.slice(17,20)).once('value').then((snapshot) => {\r\n                setEndPower((snapshot.val() && snapshot.val().Cumulative_Power)) ;\r\n                })\r\n            }\r\n            console.log(\"Start Power is \" + StartPower);\r\n            console.log(\"End Power is \" + EndPower);\r\n        });\r\n    }\r\n    \r\n    const handleSignOut = () => {\r\n        var database = firebase.database();\r\n        var user = firebase.auth().currentUser;\r\n        var now = new Date();\r\n        var date = (now.getMonth() + 1) + \"-\" + now.getDate() + \",\" + now.getHours() + \":\" + now.getMinutes();        \r\n        \r\n        firebase.auth().signOut()\r\n\r\n        database.ref('/Socket ID/' + data.slice(17,20)).once('value').then(function(snapshot) {\r\n            database.ref('/Socket ID/' + data.slice(17,20) + '/User_Activity/' + date).update({\r\n                Power_Consumed: snapshot.val() && snapshot.val().Cumulative_Power - StartPower,\r\n                User_Email: user.email,\r\n                User_ID: user.uid,\r\n                Time_of_Sign_Out: now + \"\"\r\n            }).then((data) => {\r\n                console.log('data', data)\r\n            }).catch((error) => {\r\n                console.log('error', error)\r\n            })\r\n\r\n            database.ref('/Usage History/' + user.uid).push({\r\n                Power_Consumed: snapshot.val() && snapshot.val().Cumulative_Power - StartPower,\r\n                Socket_Used: data.slice(17,20),\r\n                Time_of_Sign_Out: now + \"\"\r\n            }).then((data) => {\r\n                console.log('data', data)\r\n            }).catch((error) => {\r\n                console.log('error', error)\r\n            })\r\n\r\n            setEndPower((snapshot.val() && snapshot.val().Cumulative_Power)) ;\r\n        })\r\n\r\n\r\n        database.ref('/Socket ID/' + data.slice(17,20)).update({\r\n            AppSwitch: 0,\r\n            Completion_Time: 0,\r\n            Current_User_Email: 'no user'\r\n        }).then((data) => {\r\n            console.log('data', data)\r\n        }).catch((error) => {\r\n            console.log('error', error)\r\n        })\r\n    };\r\n\r\n    const readDataforTimer = ({data}) => {\r\n        firebase.database().ref('/Socket ID/' + data.slice(17,20)).once('value').then((snapshot) => {\r\n        var SocketStatus = (snapshot.val() && snapshot.val().AppSwitch) ;\r\n        \r\n        if(SocketStatus){\r\n            navigation.push(\"Set Timer\", data);\r\n        }\r\n        else if(!SocketStatus){\r\n            alert('Socket has already been switched off');\r\n        }\r\n\r\n        else {\r\n            alert('Please wait a while');\r\n        }\r\n        })        \r\n    };\r\n    \r\n    return (\r\n        <ScrollView>\r\n            <View style={(netInfo.isConnected) ? styles.Connection_Connected: styles.Connection_Disconnected}>\r\n                <Text style = {(netInfo.isConnected) ? styles.Connection_Text: styles.Disconnection_Text}> \r\n                    {(netInfo.isConnected === true)? 'You are connected to the device' : 'You are disconnected from the device'} \r\n                </Text>\r\n            </View>\r\n            \r\n            <View style={styles.container}>\r\n                <Text style = {styles.Title}> Main Functions </Text>\r\n                <Text style = {styles.Instructions}> Control your Aily socket here. You are connected to Socket No. {data.slice(17,20)} </Text>\r\n\r\n                <TouchableOpacity\r\n                    style={(netInfo.isConnected) ? styles.Navigation_Buttons : styles.Navigation_Buttons_Disabled}\r\n                    disabled = {(netInfo.isConnected === false)}\r\n                    onPress={() => navigation.push(\"On Off\", data)}\r\n                >\r\n                    <Text style = {styles.Button_Text}> Switch on/off socket </Text>\r\n                </TouchableOpacity>   \r\n\r\n                <TouchableOpacity\r\n                    style={(netInfo.isConnected) ? styles.Navigation_Buttons : styles.Navigation_Buttons_Disabled}\r\n                    disabled = {(netInfo.isConnected === false)}\r\n                    onPress={() => readDataforTimer({data}) }\r\n                >\r\n                    <Text style = {styles.Button_Text}> Switch on/off socket via schedule </Text>\r\n                </TouchableOpacity>   \r\n\r\n                <TouchableOpacity\r\n                    style={(netInfo.isConnected) ? styles.Navigation_Buttons : styles.Navigation_Buttons_Disabled}\r\n                    disabled = {(netInfo.isConnected === false)}\r\n                    onPress={() => navigation.push(\"Power Usage\", {data, StartPower})}\r\n                >\r\n                    <Text style = {styles.Button_Text}> Check Power Consumption Here </Text>\r\n                </TouchableOpacity>   \r\n\r\n                <TouchableOpacity\r\n                    style={(netInfo.isConnected) ? styles.Navigation_Buttons : styles.Navigation_Buttons_Disabled}\r\n                    disabled = {(netInfo.isConnected === false)}\r\n                    onPress={() => navigation.push(\"Past Usage\", {StartPower, EndPower})}\r\n                >\r\n                    <Text style = {styles.Button_Text}> Past Usage of Aily Sockets </Text>\r\n                </TouchableOpacity>\r\n\r\n                <TouchableOpacity\r\n                    style={styles.Navigation_Buttons}\r\n                    onPress={() => navigation.navigate(\"Scan Now\")}\r\n                >\r\n                    <Text style = {styles.Button_Text}> Use a Different Aily Socket </Text>\r\n                </TouchableOpacity>   \r\n\r\n                <TouchableOpacity\r\n                    style={styles.Log_Out_Buttons}\r\n                    onPress={() => handleSignOut() > navigation.navigate(\"Home\")}\r\n                >\r\n                    <Text style = {styles.Button_Text}> Log Out </Text>\r\n                </TouchableOpacity>   \r\n\r\n            </View>\r\n        </ScrollView>\r\n      \r\n      \r\n    );\r\n}\r\n\r\nconst styles = StyleSheet.create({\r\n    Connection_Connected: {\r\n        height: 70,\r\n        width : '100%',\r\n        flex : 1,\r\n        flexDirection: 'row',\r\n        alignItems: 'center',\r\n        justifyContent: 'space-evenly',\r\n        backgroundColor: '#00F000',\r\n        flexWrap: 'wrap',\r\n    },\r\n\r\n    Connection_Disconnected: {\r\n        height: 70,\r\n        width : '100%',\r\n        flex : 1,\r\n        flexDirection: 'row',\r\n        alignItems: 'center',\r\n        justifyContent: 'space-evenly',\r\n        backgroundColor: '#F00000',\r\n        flexWrap: 'wrap',\r\n    },\r\n\r\n    Connection_Text: {\r\n        textAlign: 'center',\r\n        color: \"#000000\", \r\n        fontWeight: \"300\", \r\n        marginTop: 50,\r\n        fontSize: 15\r\n    },\r\n\r\n    Disconnection_Text: {\r\n        textAlign: 'center',\r\n        color: \"#FFFFFF\", \r\n        fontWeight: \"300\", \r\n        marginTop: 50,\r\n        fontSize: 15\r\n    },\r\n    \r\n    container: {\r\n        height: 575,\r\n        width : '100%',\r\n        flex : 1,\r\n        flexDirection: 'row',\r\n        alignItems: 'center',\r\n        justifyContent: 'space-evenly',\r\n        backgroundColor: '#fff',\r\n        flexWrap: 'wrap',\r\n    },\r\n\r\n    Title: {\r\n        textAlign: 'center',\r\n        marginLeft: 50,\r\n        marginRight: 50,\r\n        marginTop: 10,\r\n        marginBottom: 10,\r\n        color: \"#000\", \r\n        fontWeight: \"bold\", \r\n        fontSize: 25\r\n    },\r\n\r\n    Instructions: {\r\n        textAlign: 'center',\r\n        marginLeft: 50,\r\n        marginRight: 50,\r\n        marginTop: 0,\r\n        marginBottom: 0,\r\n        color: \"#000\", \r\n        fontWeight: \"300\", \r\n        fontSize: 15\r\n    },\r\n\r\n    Navigation_Buttons: {\r\n        backgroundColor : '#000080',\r\n        borderRadius : 4,\r\n        height: 125,\r\n        width : 125,\r\n        marginLeft: 5,\r\n        marginRight: 5,\r\n        marginTop: 15,\r\n        marginBottom: 15,\r\n        alignItems: 'center',\r\n        alignSelf: 'flex-start',\r\n        justifyContent: 'center'\r\n    },\r\n\r\n    Navigation_Buttons_Disabled: {\r\n        backgroundColor : '#AAAAAA',\r\n        borderRadius : 4,\r\n        height: 125,\r\n        width : 125,\r\n        marginLeft: 5,\r\n        marginRight: 5,\r\n        marginTop: 15,\r\n        marginBottom: 15,\r\n        alignItems: 'center',\r\n        alignSelf: 'flex-start',\r\n        justifyContent: 'center'\r\n    },\r\n\r\n    Log_Out_Buttons: {\r\n        backgroundColor : '#A00000',\r\n        borderRadius : 4,\r\n        height: 125,\r\n        width : 125,\r\n        marginLeft: 5,\r\n        marginRight: 5,\r\n        marginTop: 15,\r\n        marginBottom: 15,\r\n        alignItems: 'center',\r\n        alignSelf: 'flex-start',\r\n        justifyContent: 'center'\r\n    },\r\n\r\n    Button_Text: {\r\n        textAlign: 'center',\r\n        color: \"#FFF\",\r\n        fontWeight: \"600\"\r\n    }\r\n});\r\n\r\nexport default MainFunctionScreen;"]},"metadata":{},"sourceType":"module"}